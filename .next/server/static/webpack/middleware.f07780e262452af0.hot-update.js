"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(middleware)/./src/lib/auth.ts\");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.auth)((req)=>{\n    const { pathname } = req.nextUrl;\n    const user = req.auth?.user;\n    // Always allow access to public routes\n    if (pathname.startsWith(\"/api/auth\") || pathname === \"/\" || pathname === \"/unauthorized\") {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Require authentication for all other routes\n    if (!user) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/api/auth/signin\", req.url));\n    }\n    // Check if user is trying to access admin routes\n    if (pathname.startsWith(\"/admin\")) {\n        // Check if user has admin or PM role\n        if (!user.role || ![\n            \"ADMIN\",\n            \"PM\"\n        ].includes(user.role)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/unauthorized\", req.url));\n        }\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}));\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api/auth (authentication routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */ \"/((?!api/auth|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUF3RDtBQUN0QjtBQUVsQyxpRUFBZUMsK0NBQUlBLENBQUMsQ0FBQ0M7SUFDbkIsTUFBTSxFQUFFQyxRQUFRLEVBQUUsR0FBR0QsSUFBSUUsT0FBTztJQUNoQyxNQUFNQyxPQUFPSCxJQUFJRCxJQUFJLEVBQUVJO0lBRXZCLHVDQUF1QztJQUN2QyxJQUFJRixTQUFTRyxVQUFVLENBQUMsZ0JBQWdCSCxhQUFhLE9BQU9BLGFBQWEsaUJBQWlCO1FBQ3hGLE9BQU9ILHFEQUFZQSxDQUFDTyxJQUFJO0lBQzFCO0lBRUEsOENBQThDO0lBQzlDLElBQUksQ0FBQ0YsTUFBTTtRQUNULE9BQU9MLHFEQUFZQSxDQUFDUSxRQUFRLENBQUMsSUFBSUMsSUFBSSxvQkFBb0JQLElBQUlRLEdBQUc7SUFDbEU7SUFFQSxpREFBaUQ7SUFDakQsSUFBSVAsU0FBU0csVUFBVSxDQUFDLFdBQVc7UUFDakMscUNBQXFDO1FBQ3JDLElBQUksQ0FBQ0QsS0FBS00sSUFBSSxJQUFJLENBQUM7WUFBQztZQUFTO1NBQUssQ0FBQ0MsUUFBUSxDQUFDUCxLQUFLTSxJQUFJLEdBQUc7WUFDdEQsT0FBT1gscURBQVlBLENBQUNRLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGlCQUFpQlAsSUFBSVEsR0FBRztRQUMvRDtJQUNGO0lBRUEsT0FBT1YscURBQVlBLENBQUNPLElBQUk7QUFDMUIsRUFBRSxFQUFDO0FBRUksTUFBTU0sU0FBUztJQUNwQkMsU0FBUztRQUNQOzs7Ozs7S0FNQyxHQUNEO0tBQ0Q7QUFDSCxFQUFFIiwic291cmNlcyI6WyIvVXNlcnMvdmljcy94dGVhbS1saW5reC9zcmMvbWlkZGxld2FyZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBhdXRoIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXV0aCgocmVxKSA9PiB7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcS5uZXh0VXJsO1xuICBjb25zdCB1c2VyID0gcmVxLmF1dGg/LnVzZXI7XG5cbiAgLy8gQWx3YXlzIGFsbG93IGFjY2VzcyB0byBwdWJsaWMgcm91dGVzXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdXRoXCIpIHx8IHBhdGhuYW1lID09PSBcIi9cIiB8fCBwYXRobmFtZSA9PT0gXCIvdW5hdXRob3JpemVkXCIpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIFJlcXVpcmUgYXV0aGVudGljYXRpb24gZm9yIGFsbCBvdGhlciByb3V0ZXNcbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL2FwaS9hdXRoL3NpZ25pblwiLCByZXEudXJsKSk7XG4gIH1cblxuICAvLyBDaGVjayBpZiB1c2VyIGlzIHRyeWluZyB0byBhY2Nlc3MgYWRtaW4gcm91dGVzXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FkbWluXCIpKSB7XG4gICAgLy8gQ2hlY2sgaWYgdXNlciBoYXMgYWRtaW4gb3IgUE0gcm9sZVxuICAgIGlmICghdXNlci5yb2xlIHx8ICFbXCJBRE1JTlwiLCBcIlBNXCJdLmluY2x1ZGVzKHVzZXIucm9sZSkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi91bmF1dGhvcml6ZWRcIiwgcmVxLnVybCkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xufSk7XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAvKlxuICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbiAgICAgKiAtIGFwaS9hdXRoIChhdXRoZW50aWNhdGlvbiByb3V0ZXMpXG4gICAgICogLSBfbmV4dC9zdGF0aWMgKHN0YXRpYyBmaWxlcylcbiAgICAgKiAtIF9uZXh0L2ltYWdlIChpbWFnZSBvcHRpbWl6YXRpb24gZmlsZXMpXG4gICAgICogLSBmYXZpY29uLmljbyAoZmF2aWNvbiBmaWxlKVxuICAgICAqL1xuICAgIFwiLygoPyFhcGkvYXV0aHxfbmV4dC9zdGF0aWN8X25leHQvaW1hZ2V8ZmF2aWNvbi5pY28pLiopXCIsXG4gIF0sXG59OyJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJhdXRoIiwicmVxIiwicGF0aG5hbWUiLCJuZXh0VXJsIiwidXNlciIsInN0YXJ0c1dpdGgiLCJuZXh0IiwicmVkaXJlY3QiLCJVUkwiLCJ1cmwiLCJyb2xlIiwiaW5jbHVkZXMiLCJjb25maWciLCJtYXRjaGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});